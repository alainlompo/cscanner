{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"CScanner: A Cloud Security Scanner This utility is intended to check your cloud configuration for compliance with your companies rules in an automated fashion, not unlike AWS config. For example, if you want to make sure that your port 22 is never open to the world, across all your cloud providers, you could do something like this: connections: # Configure your connections here rules: - type: FIREWALL_PUBLIC_SERVICE_PROHIBITED protocol: tcp ports: - 22 You would then get a report detailing all your security groups across all your cloud providers and if they are compliant or are violating the rules. Downloading You can grab one of the releases from GitHub. Running To run the cscanner, simply point it to your config file: java -jar cscanner.jar your-config-file.yaml Make sure you have at least Java 8 to run this application. Configuring The cloud scanner is configured using YAML files. The yaml files have two sections: connections and rules . The layout looks roughly like this: --- connections: # Cloud provider connections go here rules: # Compliance rules go here In connections you configure your various cloud accounts, such as this: exoscale-test: type: exoscale key: secret: The respective options for each cloud provider are documented in their documentation. The connection name can then referenced with the rules. The next section is the rules section, which you can specify your rules in: - type: FIREWALL_PUBLIC_SERVICE_PROHIBITED protocol: tcp ports: - 22 Each rule has two universal parameters: type to specify the rule type and connections which you can use to limit the rule to only certian connections. The default is to use all connections. If a certain cloud provider doesn't support a specific functionality, that cloud provider will be simply skipped for the specified rule. Supported cloud providers Currently the following cloud providers are supported: Amazon Web Services Exoscale Supported rules Currently the following rule sets are supported: Firewall S3 Compiling If you want to compile the utility from source, you will need Maven . Using Maven and at least a JDK compatible with Java 8 you should be able to simply run mvn package to compile the source code and then find the compiled binaries in cli/target .","title":"Home"},{"location":"#cscanner-a-cloud-security-scanner","text":"This utility is intended to check your cloud configuration for compliance with your companies rules in an automated fashion, not unlike AWS config. For example, if you want to make sure that your port 22 is never open to the world, across all your cloud providers, you could do something like this: connections: # Configure your connections here rules: - type: FIREWALL_PUBLIC_SERVICE_PROHIBITED protocol: tcp ports: - 22 You would then get a report detailing all your security groups across all your cloud providers and if they are compliant or are violating the rules.","title":"CScanner: A Cloud Security Scanner"},{"location":"#downloading","text":"You can grab one of the releases from GitHub.","title":"Downloading"},{"location":"#running","text":"To run the cscanner, simply point it to your config file: java -jar cscanner.jar your-config-file.yaml Make sure you have at least Java 8 to run this application.","title":"Running"},{"location":"#configuring","text":"The cloud scanner is configured using YAML files. The yaml files have two sections: connections and rules . The layout looks roughly like this: --- connections: # Cloud provider connections go here rules: # Compliance rules go here In connections you configure your various cloud accounts, such as this: exoscale-test: type: exoscale key: secret: The respective options for each cloud provider are documented in their documentation. The connection name can then referenced with the rules. The next section is the rules section, which you can specify your rules in: - type: FIREWALL_PUBLIC_SERVICE_PROHIBITED protocol: tcp ports: - 22 Each rule has two universal parameters: type to specify the rule type and connections which you can use to limit the rule to only certian connections. The default is to use all connections. If a certain cloud provider doesn't support a specific functionality, that cloud provider will be simply skipped for the specified rule.","title":"Configuring"},{"location":"#supported-cloud-providers","text":"Currently the following cloud providers are supported: Amazon Web Services Exoscale","title":"Supported cloud providers"},{"location":"#supported-rules","text":"Currently the following rule sets are supported: Firewall S3","title":"Supported rules"},{"location":"#compiling","text":"If you want to compile the utility from source, you will need Maven . Using Maven and at least a JDK compatible with Java 8 you should be able to simply run mvn package to compile the source code and then find the compiled binaries in cli/target .","title":"Compiling"},{"location":"clouds/aws/","text":"Amazon Web Services Amazon Web Services , or AWS, is a popular cloud provider and is supported by cscanner. The configuration does as follows: connection-name: type: aws accessKeyId: secretAccessKey: sessionToken: profile: Each of the parameters is optional. If they are not provided, the default is to fall back to the AWS client default behavior, such as reading options from environment variables or credentials files. Rules The AWS provider currently supports the following rules: Firewall S3","title":"Amazon Web Services"},{"location":"clouds/aws/#amazon-web-services","text":"Amazon Web Services , or AWS, is a popular cloud provider and is supported by cscanner. The configuration does as follows: connection-name: type: aws accessKeyId: secretAccessKey: sessionToken: profile: Each of the parameters is optional. If they are not provided, the default is to fall back to the AWS client default behavior, such as reading options from environment variables or credentials files.","title":"Amazon Web Services"},{"location":"clouds/aws/#rules","text":"The AWS provider currently supports the following rules: Firewall S3","title":"Rules"},{"location":"clouds/exoscale/","text":"Exoscale Exoscale is a European/Swiss IaaS cloud provider and is supported by cscanner. Under the hood it implements a CloudStack-like API. The configuration goes like this: exoscale-test: type: exoscale key: secret: Note, that cloudstack.ini is currently not supported. Rules The Exoscale provider supports the following rule sets: Firewall S3 Exoscale SOS/S3 compatibility Exoscale SOS does not support bucket ACLs, so you need to set scanContents to true on the S3_PUBLIC_READ_PROHIBITED rule to take effect. Otherwise this rule will do nothing.","title":"Exoscale"},{"location":"clouds/exoscale/#exoscale","text":"Exoscale is a European/Swiss IaaS cloud provider and is supported by cscanner. Under the hood it implements a CloudStack-like API. The configuration goes like this: exoscale-test: type: exoscale key: secret: Note, that cloudstack.ini is currently not supported.","title":"Exoscale"},{"location":"clouds/exoscale/#rules","text":"The Exoscale provider supports the following rule sets: Firewall S3 Exoscale SOS/S3 compatibility Exoscale SOS does not support bucket ACLs, so you need to set scanContents to true on the S3_PUBLIC_READ_PROHIBITED rule to take effect. Otherwise this rule will do nothing.","title":"Rules"},{"location":"rules/firewall/","text":"Firewall rules This section details how to configure the firewall compliance rules. Do not permit a certain port to be public This rule fails if there is a firewall rule allowing access to a certain port from the whole internet ( 0.0.0.0/0 or ::/0 ). The configuration is as follows: - type: FIREWALL_PUBLIC_SERVICE_PROHIBITED protocol: tcp ports: - 22 include: - some.*regexp exclude: - public protocol This option specifies the protocol, either as a name or a number. It accepts only a single protocol. ports This option accepts a list of ports that should be checked. include This option accepts a regular expression to match against the security group name. If include is specified, only the security groups with the specified name will be considered. Note that each cloud provider implements security groups differently. The AWS provider , for example, will return an ARN. (To Be Fixed) exclude This option lets you exclude certain firewall / security groups from checking, similar to include above. The exclude rule takes precedence over include.","title":"Firewall"},{"location":"rules/firewall/#firewall-rules","text":"This section details how to configure the firewall compliance rules.","title":"Firewall rules"},{"location":"rules/firewall/#do-not-permit-a-certain-port-to-be-public","text":"This rule fails if there is a firewall rule allowing access to a certain port from the whole internet ( 0.0.0.0/0 or ::/0 ). The configuration is as follows: - type: FIREWALL_PUBLIC_SERVICE_PROHIBITED protocol: tcp ports: - 22 include: - some.*regexp exclude: - public","title":"Do not permit a certain port to be public"},{"location":"rules/firewall/#protocol","text":"This option specifies the protocol, either as a name or a number. It accepts only a single protocol.","title":"protocol"},{"location":"rules/firewall/#ports","text":"This option accepts a list of ports that should be checked.","title":"ports"},{"location":"rules/firewall/#include","text":"This option accepts a regular expression to match against the security group name. If include is specified, only the security groups with the specified name will be considered. Note that each cloud provider implements security groups differently. The AWS provider , for example, will return an ARN. (To Be Fixed)","title":"include"},{"location":"rules/firewall/#exclude","text":"This option lets you exclude certain firewall / security groups from checking, similar to include above. The exclude rule takes precedence over include.","title":"exclude"},{"location":"rules/s3/","text":"S3 Rules This section details the rules relevant to AWS S3 and compatible object storages. Do not permit an S3 bucket to be public This rule checks S3 bucket ACLs so that they are not public. The configuration goes like this: - type: S3_PUBLIC_READ_PROHIBITED include: - some.*regexp exclude: - some.*regexp include This option accepts a regular expression to match against the bucket name. If include is specified, only the security groups with the specified name will be considered. Note that each cloud provider implements buckets differently. The AWS provider , for example, will return an ARN. exclude This option lets you exclude certain buckets from checking, similar to include above. The exclude rule takes precedence over include. scanContents This is a true/false flag indicating if the contents of the buckets should be scanned for ACL violations. If true all files in the bucket will be checked, which may take a very long time. If false only the bucket ACL will be evaluated. Exoscale SOS/S3 compatibility Exoscale SOS does not support bucket ACLs, so you need to set scanContents to true on the S3_PUBLIC_READ_PROHIBITED rule to take effect. Otherwise this rule will do nothing.","title":"S3"},{"location":"rules/s3/#s3-rules","text":"This section details the rules relevant to AWS S3 and compatible object storages.","title":"S3 Rules"},{"location":"rules/s3/#do-not-permit-an-s3-bucket-to-be-public","text":"This rule checks S3 bucket ACLs so that they are not public. The configuration goes like this: - type: S3_PUBLIC_READ_PROHIBITED include: - some.*regexp exclude: - some.*regexp","title":"Do not permit an S3 bucket to be public"},{"location":"rules/s3/#include","text":"This option accepts a regular expression to match against the bucket name. If include is specified, only the security groups with the specified name will be considered. Note that each cloud provider implements buckets differently. The AWS provider , for example, will return an ARN.","title":"include"},{"location":"rules/s3/#exclude","text":"This option lets you exclude certain buckets from checking, similar to include above. The exclude rule takes precedence over include.","title":"exclude"},{"location":"rules/s3/#scancontents","text":"This is a true/false flag indicating if the contents of the buckets should be scanned for ACL violations. If true all files in the bucket will be checked, which may take a very long time. If false only the bucket ACL will be evaluated. Exoscale SOS/S3 compatibility Exoscale SOS does not support bucket ACLs, so you need to set scanContents to true on the S3_PUBLIC_READ_PROHIBITED rule to take effect. Otherwise this rule will do nothing.","title":"scanContents"}]}